"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react-dom")),r=require("react"),n=e(r),a=e(require("react-modal")),l=require("events"),i=require("rxjs"),o=e(require("qrcode.react")),s=require("@ngraveio/bc-ur");const c=({size:e=200,data:t="",ecl:r="L"})=>n.createElement(o,{value:t,size:e,level:r});var A,u,m;(A=exports.ReadStatus||(exports.ReadStatus={})).canceled="canceled",A.success="success",(u=exports.PlayStatus||(exports.PlayStatus={})).canceled="canceled",u.success="success",(m=exports.SupportedResult||(exports.SupportedResult={})).UR_BYTES="bytes",m.UR_CRYPTO_HDKEY="crypto-hdkey",m.UR_CRYPTO_ACCOUNT="crypto-account",m.UR_ETH_SIGN_REQUEST="eth-sign-request",m.UR_ETH_SIGNATURE="eth-signature",m.UR_CRYPTO_MULTI_ACCOUNTS="crypto-multi-accounts",m.UR_SOL_SIGN_REQUEST="sol-sign-request",m.UR_SOL_SIGNATURE="sol-signature";const d={minWidth:"16rem",height:"3rem",background:"#784FFE",borderColor:"grey",borderRadius:"8px",borderWidth:1,color:"white",outline:"none",margin:2},y=e=>{const{onClick:t,children:r}=e;return n.createElement("button",{onClick:t,style:d},r)},g=e=>n.createElement("div",{style:{width:"100%",marginTop:"1rem",display:"flex",flexDirection:"row-reverse",alignItems:"center",justifyContent:"center"}},e.children),E=new s.UR(Buffer.from("NO DATA","utf-8"));class p extends Error{constructor(e){super(e),Object.setPrototypeOf(this,p.prototype)}}const S=()=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{margin:"auto",display:"block",shapeRendering:"auto",animationPlayState:"running",animationDelay:"0s"},width:"200px",height:"200px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},n.createElement("circle",{cx:"50",cy:"50",fill:"none",stroke:"#9b9b9b",strokeWidth:"7",r:"35",strokeDasharray:"164.93361431346415 56.97787143782138",style:{animationPlayState:"running",animationDelay:"0s"}},n.createElement("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",values:"0 50 50;360 50 50",keyTimes:"0;1",style:{animationPlayState:"running",animationDelay:"0s"}}))),f=n.lazy(()=>new Promise((function(e){e(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t.default=e,t}(require("react-qr-reader")))})));let h="";const v=e=>n.createElement("div",{style:{paddingLeft:"1rem"}},n.createElement("div",{style:{display:"flex",alignItems:"center",padding:0}},n.createElement("img",{style:{display:"inline-block"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAKAAAAACc9ikyAAAD+ElEQVRYCb1WbWiNURw/Z9caY5SyrKzVhuUtZcYoJdZ8kMywGClG+WK+eJsPmogNKfZBxBbmAyPyEgvtA8UUX9inbVeb8AGTd8t2j9/vdp91ntPzPPd57h3/+t1z/uf/ev7nnP9zhUiMsmH2BOgF9ifmIjmrVpgrDWuScxfMeqUW2EqiB2sjgrlJTDsNZmHACqyP2xJzGcyq2iU4E7kTzFVw7fEw+Qbou9bn94K7FCIlgNFh6I7y0E8oAQ9/NlEBuAig71ifv4VspM1iiJnHHsGZyPohjmdzxzeu79acsyFJm8UQMnzbfONmUIvnsRTG4g3DWAM8B24DM4GkaR88WMGcxkYtQr2h+wl8niYPPJ0Aix+AU2Cu8UlmASRe0gHA1L1JYaLUBEPToc7v1hx7XdISTc/3tAiaXs+uE3K2ZdJaQE/MnLdDzvvhm3ij2wDTkc4vj3lLx/gmji7tqmL6voYNcRze17zwv4CemNuc/xt8NSoqsau5OfoD2TSAxDb+EXDTNdeX0igeHYSCaajzfGoWZWDidU90O84XWIZuYw4EvwDT0OK527GG8VUPfcuO4wPAsVvqt/MolIYDbsSmxLPUiS+gEpgBOH1Z+7HOC90MMBFXYnn0jM35S8hDrtZJCFgBluZEHB/bIWenc6XVV1Qo/MCxCoM2ucUi0lwubX4YfBng1TKvQ1426MWY1NSolAs94jJKVoYaOh2DbqGw3ddQqutqkGcooEG5rmHM+8DvMNZs7KVuUaiUWOUjOO0k9HIjSpzOq1RRv0xgus2jnTkONhxbKsZ4A7gFlMbWRChddMLtZ4v3O0YiojZvq8rkEbwCrOai278Dkw98BxYBLYD+anaB58sREzerosiAaMExjCbvl0KpooAV6HIx2IN1Bk8FTgF6cLDiCLCTk86z8mlKSCzBbr6S90NSooumiXYm8MjBgG+3KbZehXGygw6XmAQrEU0C77TETxII3ofA6zrrZR+PIAvoBrhTEnvAPIBJZAIdQLzS8r8BkxGTNqq5AxLHocQY8iYxOIKuwCu4Sxkr8B7g5bLoIiYMTjoExAtOvTqASYiORtmmJCohxRfyBv3GeqkVnDJWgLQQaAV45iw3k5oKsAMySb9UDcVaKuduUYWiX1xDObPJI/AHDBXhBsnvwiBZCXChAuA/nWdkQLxg0bJGOf8/tDtG9fxNKqNfisX4ZKamC/Gw/Zzs9e9GiL1Q5n0ICn6A5gQJ5KY7C4Ig33s90WibdXOsr3ud7wsoshcwiaAUPfegRm76syHgBylINaIX0c1hout8FecB/i/Uy23OedvZP/4Z5cDzSeAnYAZnK54P/BcahygHAD5dNh12tilAIPoLD0OnpwCV000AAAAASUVORK5CYII=",alt:""}),n.createElement("div",{style:{fontSize:"1.25rem",fontWeight:"bold",marginLeft:"1rem"}},"Sync Keystone")),n.createElement("ul",{style:{marginTop:"2rem",listStyleType:"none",padding:0,fontSize:"1rem"}},n.createElement("li",{style:{marginBottom:"0.75rem"}},"1. Turn on your Keystone hardware device"),n.createElement("li",{style:{marginBottom:"0.75rem"}},`2. Select your "${e.walletMode}" as your Watch-only wallet(Companion App)`),n.createElement("li",{style:{marginBottom:"0.75rem"}}," ",'3. Press the "Scan Keystone" button and scan the QR Code displayed on your Keystone hardware wallet'),n.createElement("li",{style:{marginBottom:"0.75rem"}}," ","4. Select account and check your watch-only wallet")),n.createElement("div",{style:{marginBottom:"1rem"}},n.createElement("a",{style:{marginTop:"1.25rem",color:"#784FFE",textDecoration:"none"},href:e.link,target:"_blank",rel:"noreferrer"},"Click here to view detailed tutorial")),n.createElement(y,{onClick:e.onButtonClick},"Sync Keystone")),x={overlay:{zIndex:999},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",borderRadius:"10px",width:"37rem",marginRight:"-50%",transform:"translate(-50%, -50%)",postion:"relative"}};var w=()=>{const[e,{read:t,play:o,cameraReady:A}]=(()=>{const e=r.useMemo(()=>new l.EventEmitter,[]),[t,o]=r.useState(!1),[A,u]=r.useState(""),[m,d]=r.useState(""),[w,R]=r.useState(null),[b,{play:C}]=(()=>{const[e,t]=r.useState(E),[a,o]=r.useState(!1),[A,u]=r.useState(100),[m,d]=r.useState(400),[p,S]=r.useState(!1),[f,h]=r.useState(null),[v,x]=r.useState(null),w=r.useMemo(()=>new s.UREncoder(e,m),[e]),[R,b]=r.useState(w.nextPart()),C=r.useMemo(()=>new l.EventEmitter,[]);return r.useEffect(()=>{w.cbor.toString("hex")!==E.cbor.toString("hex")&&o(!0)},[w]),r.useEffect(()=>{const e=i.interval(A).subscribe(()=>{b(w.nextPart())});return()=>{e.unsubscribe()}},[A,w]),[a?n.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},f&&n.createElement("p",{style:{fontSize:"1.25rem",fontWeight:"bold"}},f),n.createElement(c,{size:288,data:R}),v&&n.createElement("p",{style:{fontSize:"1rem",textAlign:"center"}},v),n.createElement(g,null,n.createElement(y,{onClick:()=>{C.emit("finish",!0)}},p?"Scan Keystone":"Finish"))):n.createElement("div",null),{play:(e,r)=>new Promise(n=>{t(e),r&&(r.refreshSpeed&&u(r.refreshSpeed),r.hasNext&&S(r.hasNext),r.title&&h(r.title),r.description&&x(r.description),r.maxFragmentLength&&d(r.maxFragmentLength)),C.once("finish",()=>{t(E),o(!1),u(100),n(exports.PlayStatus.success)})})}]})(),[B,{read:D,cameraReady:U}]=(()=>{const[e,t]=r.useState(!1),[a,i]=r.useState([]),[o,c]=r.useState(new s.URDecoder),[A,u]=r.useState(""),m=r.useMemo(()=>new l.EventEmitter,[]),[d,E]=r.useState(null),[v,x]=r.useState(0),[w,R]=r.useState(null),b=()=>{c(new s.URDecoder),u("")};return[n.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},d&&n.createElement("p",{style:{fontSize:"1.25rem",fontWeight:"bold"}},d),w&&n.createElement("p",{style:{fontSize:"1rem",textAlign:"center"}},w),n.createElement(r.Suspense,{fallback:n.createElement("div",null)},n.createElement("div",{style:{position:"relative",width:"100%"}},e?null:n.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},n.createElement(S,null)),n.createElement(f,{onScan:e=>{e&&(t(!0),((e,t)=>{try{if(o.isComplete()){const e=o.resultUR();let t=!1;if(a.forEach(r=>{if(r===e.type)return t=!0,void m.emit("read",{result:e,status:"success"})}),!t)throw new p(`received ur type ${e.type}, but expected [${a.join(",")}]`)}else o.receivePart(e),x(o.getProgress())}catch(e){u(e instanceof p?t:e.message)}})(e,h))},delay:100,style:{width:"100%"},onError:e=>{u(e.message)}}))),n.createElement("p",null,(100*v).toFixed(0)," %"),A&&n.createElement("p",{style:{color:"red",fontSize:"1rem"}},A),n.createElement(g,null,n.createElement(y,{onClick:()=>{m.emit("read",{status:"canceled"})}},"Close"),A&&n.createElement(y,{onClick:()=>{b()}},"Retry"))),{read:(e,t)=>new Promise(r=>{i(e),t&&(t.title&&E(t.title),t.description&&R(t.description),h=t.URTypeErrorMessage?t.URTypeErrorMessage:""),m.once("read",e=>{b(),r(e)})}),cameraReady:e}]})(),k=()=>{R(null),d(""),u(""),o(!1)};var P;return[n.createElement(a,{isOpen:t,style:x},n.createElement("div",{onClick:()=>{e.emit("close"),k()}},n.createElement("img",{style:{position:"absolute",top:"1rem",right:"1rem"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADKADAAQAAAABAAAADAAAAAATDPpdAAAAmklEQVQoFZWRwQ3DIAwAa4brJPBP80hnaD/lD5N0iYxEfRVBxBGRwsvgO2PZklJaReTrvX/eTk7O+VVKuTtgDRYVPyOeHAysAFV40jCGEB69aHN/YSRZGK4JVuKu5/DrToDoqnI9tOh4vXJ2Qlc96kSY2lTfWs0m9DCT0r3MSkUrXR9r3eBCNbuDrY/td23z7Vg3wQhGIgcD+wPGY2fPvHuWagAAAABJRU5ErkJggg=="})),n.createElement("div",{style:{width:"35rem",padding:18,flex:1,flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#002237"}},"initial"===(P=w)?n.createElement(v,{walletMode:A,link:m,onButtonClick:()=>{R("read")}}):"read"===P?B:"play"===P?b:null)),{play:(t,r)=>new Promise(n=>{e.once("close",()=>{n(exports.PlayStatus.canceled)}),o(!0),R("play"),C(t,r).then(()=>{k(),n(exports.PlayStatus.success)})}),read:async(t,r)=>new Promise(n=>{e.once("close",()=>{k(),n({status:exports.ReadStatus.canceled})}),r.renderInitial?(u(r.renderInitial.walletMode),d(r.renderInitial.link),R("initial"),o(!0),D(t,r).then(e=>{k(),n(e)})):(R("read"),o(!0),D(t,r).then(e=>{k(),n(e)}))}),cameraReady:U}]})();return D(t,o,A),e};let R,b,C,B=!1;const D=(e,t,r)=>{B=!0,R=e,b=t,C=r};exports.default={bootstrap:()=>{const e=document.getElementsByTagName("body").item(0),r=document.createElement("div");r.id="kv_sdk_container",e.appendChild(r),a.setAppElement("#kv_sdk_container"),t.render(n.createElement(w),r)},getSdk:()=>{if(B)return{read:R,play:b,cameraReady:C};throw new Error("SDK is not initialized")}};
//# sourceMappingURL=sdk.cjs.production.min.js.map
