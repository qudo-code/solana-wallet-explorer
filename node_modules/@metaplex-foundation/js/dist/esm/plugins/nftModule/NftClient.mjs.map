{"version":3,"file":"NftClient.mjs","sources":["../../../../src/plugins/nftModule/NftClient.ts"],"sourcesContent":["import type { Metaplex } from '@/Metaplex';\nimport { token } from '@/types';\nimport { PartialKeys, Task } from '@/utils';\nimport { Metadata } from '@metaplex-foundation/mpl-token-metadata';\nimport { PublicKey } from '@solana/web3.js';\nimport { SendTokensInput } from '../tokenModule';\nimport { toMintAddress } from './helpers';\nimport { Nft, NftWithToken, Sft, SftWithToken } from './models';\nimport { NftBuildersClient } from './NftBuildersClient';\nimport {\n  ApproveNftCollectionAuthorityInput,\n  approveNftCollectionAuthorityOperation,\n  ApproveNftUseAuthorityInput,\n  approveNftUseAuthorityOperation,\n  CreateNftInput,\n  createNftOperation,\n  CreateSftInput,\n  createSftOperation,\n  DeleteNftInput,\n  deleteNftOperation,\n  FindNftByMetadataInput,\n  findNftByMetadataOperation,\n  FindNftByMintInput,\n  findNftByMintOperation,\n  FindNftByTokenInput,\n  findNftByTokenOperation,\n  FindNftsByCreatorInput,\n  findNftsByCreatorOperation,\n  FindNftsByMintListInput,\n  findNftsByMintListOperation,\n  FindNftsByOwnerInput,\n  findNftsByOwnerOperation,\n  FindNftsByUpdateAuthorityInput,\n  findNftsByUpdateAuthorityOperation,\n  FreezeDelegatedNftInput,\n  freezeDelegatedNftOperation,\n  LoadMetadataInput,\n  loadMetadataOperation,\n  MigrateToSizedCollectionNftInput,\n  migrateToSizedCollectionNftOperation,\n  PrintNewEditionInput,\n  printNewEditionOperation,\n  RevokeNftCollectionAuthorityInput,\n  revokeNftCollectionAuthorityOperation,\n  RevokeNftUseAuthorityInput,\n  revokeNftUseAuthorityOperation,\n  ThawDelegatedNftInput,\n  thawDelegatedNftOperation,\n  UnverifyNftCollectionInput,\n  unverifyNftCollectionOperation,\n  UnverifyNftCreatorInput,\n  unverifyNftCreatorOperation,\n  UpdateNftInput,\n  updateNftOperation,\n  UploadMetadataInput,\n  uploadMetadataOperation,\n  UseNftInput,\n  useNftOperation,\n  VerifyNftCollectionInput,\n  verifyNftCollectionOperation,\n  VerifyNftCreatorInput,\n  verifyNftCreatorOperation,\n} from './operations';\n\n/**\n * @group Modules\n */\nexport class NftClient {\n  constructor(protected readonly metaplex: Metaplex) {}\n\n  builders() {\n    return new NftBuildersClient(this.metaplex);\n  }\n\n  // -----------------\n  // Queries\n  // -----------------\n\n  /** {@inheritDoc findNftByMintOperation} */\n  findByMint(input: FindNftByMintInput) {\n    return this.metaplex.operations().getTask(findNftByMintOperation(input));\n  }\n\n  /** {@inheritDoc findNftByMetadataOperation} */\n  findByMetadata(input: FindNftByMetadataInput) {\n    return this.metaplex\n      .operations()\n      .getTask(findNftByMetadataOperation(input));\n  }\n\n  /** {@inheritDoc findNftByTokenOperation} */\n  findByToken(input: FindNftByTokenInput) {\n    return this.metaplex.operations().getTask(findNftByTokenOperation(input));\n  }\n\n  /** {@inheritDoc findNftsByCreatorOperation} */\n  findAllByCreator(input: FindNftsByCreatorInput) {\n    return this.metaplex\n      .operations()\n      .getTask(findNftsByCreatorOperation(input));\n  }\n\n  /** {@inheritDoc findNftsByMintListOperation} */\n  findAllByMintList(input: FindNftsByMintListInput) {\n    return this.metaplex\n      .operations()\n      .getTask(findNftsByMintListOperation(input));\n  }\n\n  /** {@inheritDoc findNftsByOwnerOperation} */\n  findAllByOwner(input: FindNftsByOwnerInput) {\n    return this.metaplex.operations().getTask(findNftsByOwnerOperation(input));\n  }\n\n  /** {@inheritDoc findNftsByUpdateAuthorityOperation} */\n  findAllByUpdateAuthority(input: FindNftsByUpdateAuthorityInput) {\n    return this.metaplex\n      .operations()\n      .getTask(findNftsByUpdateAuthorityOperation(input));\n  }\n\n  /** {@inheritDoc loadMetadataOperation} */\n  load(input: LoadMetadataInput) {\n    return this.metaplex.operations().getTask(loadMetadataOperation(input));\n  }\n\n  /**\n   * Helper method that refetches a given model\n   * and returns an instance of the same type.\n   */\n  refresh<\n    T extends Nft | Sft | NftWithToken | SftWithToken | Metadata | PublicKey\n  >(\n    model: T,\n    input?: Omit<\n      FindNftByMintInput,\n      'mintAddress' | 'tokenAddres' | 'tokenOwner'\n    >\n  ): Task<T extends Metadata | PublicKey ? Nft | Sft : T> {\n    return this.findByMint({\n      mintAddress: toMintAddress(model),\n      tokenAddress: 'token' in model ? model.token.address : undefined,\n      ...input,\n    }) as Task<T extends Metadata | PublicKey ? Nft | Sft : T>;\n  }\n\n  // -----------------\n  // Create, Update and Delete\n  // -----------------\n\n  /** {@inheritDoc createNftOperation} */\n  create(input: CreateNftInput) {\n    return this.metaplex.operations().getTask(createNftOperation(input));\n  }\n\n  /** {@inheritDoc createSftOperation} */\n  createSft(input: CreateSftInput) {\n    return this.metaplex.operations().getTask(createSftOperation(input));\n  }\n\n  /** {@inheritDoc printNewEditionOperation} */\n  printNewEdition(input: PrintNewEditionInput) {\n    return this.metaplex.operations().getTask(printNewEditionOperation(input));\n  }\n\n  /** {@inheritDoc uploadMetadataOperation} */\n  uploadMetadata(input: UploadMetadataInput) {\n    return this.metaplex.operations().getTask(uploadMetadataOperation(input));\n  }\n\n  /** {@inheritDoc updateNftOperation} */\n  update(input: UpdateNftInput) {\n    return this.metaplex.operations().getTask(updateNftOperation(input));\n  }\n\n  /** {@inheritDoc deleteNftOperation} */\n  delete(input: DeleteNftInput) {\n    return this.metaplex.operations().getTask(deleteNftOperation(input));\n  }\n\n  // -----------------\n  // Use\n  // -----------------\n\n  /** {@inheritDoc useNftOperation} */\n  use(input: UseNftInput) {\n    return this.metaplex.operations().getTask(useNftOperation(input));\n  }\n\n  /** {@inheritDoc approveNftUseAuthorityOperation} */\n  approveUseAuthority(input: ApproveNftUseAuthorityInput) {\n    return this.metaplex\n      .operations()\n      .getTask(approveNftUseAuthorityOperation(input));\n  }\n\n  /** {@inheritDoc revokeNftUseAuthorityOperation} */\n  revokeUseAuthority(input: RevokeNftUseAuthorityInput) {\n    return this.metaplex\n      .operations()\n      .getTask(revokeNftUseAuthorityOperation(input));\n  }\n\n  // -----------------\n  // Creators\n  // -----------------\n\n  /** {@inheritDoc verifyNftCreatorOperation} */\n  verifyCreator(input: VerifyNftCreatorInput) {\n    return this.metaplex.operations().getTask(verifyNftCreatorOperation(input));\n  }\n\n  /** {@inheritDoc unverifyNftCreatorOperation} */\n  unverifyCreator(input: UnverifyNftCreatorInput) {\n    return this.metaplex\n      .operations()\n      .getTask(unverifyNftCreatorOperation(input));\n  }\n\n  // -----------------\n  // Collections\n  // -----------------\n\n  /** {@inheritDoc verifyNftCollectionOperation} */\n  verifyCollection(input: VerifyNftCollectionInput) {\n    return this.metaplex\n      .operations()\n      .getTask(verifyNftCollectionOperation(input));\n  }\n\n  /** {@inheritDoc unverifyNftCollectionOperation} */\n  unverifyCollection(input: UnverifyNftCollectionInput) {\n    return this.metaplex\n      .operations()\n      .getTask(unverifyNftCollectionOperation(input));\n  }\n\n  /** {@inheritDoc approveNftCollectionAuthorityOperation} */\n  approveCollectionAuthority(input: ApproveNftCollectionAuthorityInput) {\n    return this.metaplex\n      .operations()\n      .getTask(approveNftCollectionAuthorityOperation(input));\n  }\n\n  /** {@inheritDoc revokeNftCollectionAuthorityOperation} */\n  revokeCollectionAuthority(input: RevokeNftCollectionAuthorityInput) {\n    return this.metaplex\n      .operations()\n      .getTask(revokeNftCollectionAuthorityOperation(input));\n  }\n\n  /** {@inheritDoc migrateToSizedCollectionNftOperation} */\n  migrateToSizedCollection(input: MigrateToSizedCollectionNftInput) {\n    return this.metaplex\n      .operations()\n      .getTask(migrateToSizedCollectionNftOperation(input));\n  }\n\n  // -----------------\n  // Tokens\n  // -----------------\n\n  /** {@inheritDoc freezeDelegatedNftOperation} */\n  freezeDelegatedNft(input: FreezeDelegatedNftInput) {\n    return this.metaplex\n      .operations()\n      .getTask(freezeDelegatedNftOperation(input));\n  }\n\n  /** {@inheritDoc thawDelegatedNftOperation} */\n  thawDelegatedNft(input: ThawDelegatedNftInput) {\n    return this.metaplex.operations().getTask(thawDelegatedNftOperation(input));\n  }\n\n  /** {@inheritDoc sendTokensOperation} */\n  send(input: PartialKeys<SendTokensInput, 'amount'>) {\n    return this.metaplex.tokens().send({\n      ...input,\n      amount: token(1),\n    });\n  }\n}\n"],"names":["NftClient","constructor","metaplex","builders","NftBuildersClient","findByMint","input","operations","getTask","findNftByMintOperation","findByMetadata","findNftByMetadataOperation","findByToken","findNftByTokenOperation","findAllByCreator","findNftsByCreatorOperation","findAllByMintList","findNftsByMintListOperation","findAllByOwner","findNftsByOwnerOperation","findAllByUpdateAuthority","findNftsByUpdateAuthorityOperation","load","loadMetadataOperation","refresh","model","mintAddress","toMintAddress","tokenAddress","token","address","undefined","create","createNftOperation","createSft","createSftOperation","printNewEdition","printNewEditionOperation","uploadMetadata","uploadMetadataOperation","update","updateNftOperation","delete","deleteNftOperation","use","useNftOperation","approveUseAuthority","approveNftUseAuthorityOperation","revokeUseAuthority","revokeNftUseAuthorityOperation","verifyCreator","verifyNftCreatorOperation","unverifyCreator","unverifyNftCreatorOperation","verifyCollection","verifyNftCollectionOperation","unverifyCollection","unverifyNftCollectionOperation","approveCollectionAuthority","approveNftCollectionAuthorityOperation","revokeCollectionAuthority","revokeNftCollectionAuthorityOperation","migrateToSizedCollection","migrateToSizedCollectionNftOperation","freezeDelegatedNft","freezeDelegatedNftOperation","thawDelegatedNft","thawDelegatedNftOperation","send","tokens","amount"],"mappings":"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"}